pkgname="igal_qt"
pkgver=1.12.6
pkgrel=0
epoch=0

pkgdesc="Image/Video gallery with tools"
arch=(any)
url="https://github.com/ien646/igal_qt"
license=("AGPL-3.0")
depends=(
    'qt6-base'
    'qt6-multimedia'
)
makedepends=(
    'cmake'
    'git'
    'make'
)
optdepends=(
    'kimageformats: JXL support'
)

source=("https://github.com/ien646/igal_qt-mirror/archive/refs/tags/$pkgver.tar.gz")
sha512sums=('5c3a1c051aab4d187d5b2dca9479135c52018b38adb62cdd005ecabec42ed567ee405f669083ae8cffe198534f475c8cf4ed61a7410ff71343abc5b0f69ab552')

prepare() {
    cd "igal_qt-mirror-$pkgver"
    sed -i -e 's/ien646\/libien/ien646\/libien-mirror/g' CMakeLists.txt
}

build() {
    mkdir -p "igal_qt-mirror-$pkgver/build"
    cd "igal_qt-mirror-$pkgver/build"
    cmake -DCMAKE_BUILD_TYPE=Release ..
    make -j
}

package() {
    cd "igal_qt-mirror-$pkgver/build"
    mkdir -p "${pkgdir}/usr/local/bin/"
    sudo cp igal_qt "${pkgdir}/usr/local/bin/igal_qt"
}