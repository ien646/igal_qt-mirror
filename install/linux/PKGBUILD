pkgname="igal_qt"
pkgver=1.12.6
pkgrel=0
epoch=0

pkgdesc="Image/Video gallery with tools"
arch=(any)
url="https://github.com/ien646/igal_qt"
license=("AGPL-3.0")
depends=(
    'qt6-base'
    'qt6-multimedia'
)
makedepends=(
    'cmake'
    'git'
    'make'
)
optdepends=(
    'kimageformats: JXL support'
)

source=("https://github.com/ien646/igal_qt-mirror/archive/refs/tags/$pkgver.tar.gz")
sha512sums=('deadd911f840c2ee48b514a1d640b904b059e8bb8b757197e8d9b20ba0fc66c4c3dc2eee7c1852974a2f8741ee38eb3184937d6ec8978326b7b00c71e8195014')

prepare() {
    cd "igal_qt-mirror-$pkgver"
    sed -i -e 's/ien646\/libien/ien646\/libien-mirror/g' CMakeLists.txt
}

build() {
    mkdir -p "igal_qt-mirror-$pkgver/build"
    cd "igal_qt-mirror-$pkgver/build"
    cmake -DCMAKE_BUILD_TYPE=Release ..
    make -j
}

package() {
    cd "igal_qt-mirror-$pkgver/build"
    mkdir -p "${pkgdir}/usr/local/bin/"
    sudo cp igal_qt "${pkgdir}/usr/local/bin/igal_qt"
}